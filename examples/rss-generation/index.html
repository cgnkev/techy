<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Techy / RSS generation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./../../public/font-awesome-4.0.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="./../../public/styles.css">
    <link rel="stylesheet" href="./../../public/prism/prism.css" />
    <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Open+Sans:400,800,700' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./../../public/img/favicon.png" />
    <meta property="og:image" content="http://krasimir.github.io/techy/public/img/techy.jpg" />
    <meta property="og:title" content="Techy - The geeky way of writing" />
    <meta property="og:url" content="http://krasimir.github.io/techy/" />
    <meta property="og:site_name" content="Techy - The geeky way of writing" />
</head>

<body>
    <div class="techy">
        <h1 id="rss-generation-br-small-i-class-fa-fa-arrow-circle-o-left-i-back-to-the-documentation-techy-docs-small-">RSS generation<br /><small><a href="/techy/docs"><i class="fa fa-arrow-circle-o-left"></i> Back to the documentation</a></small></h1>
        <p>Using Techy as a blog platform leads to the need of RSS feed. And because every page is actually a separate object we are able to generate RSS pretty easily. Let's say that we have the following file structure:</p>
        <pre><code class="language-javascript">/blog
    /articles
        /A.md
        /B.md
        /C.md
</code></pre>
        <p>The content of the Markdown files is as follows:</p>
        <p>A.md</p>
        <pre><code class="language-javascript">---
title: Article A
date: 10-04-2014
---

# &lt;% get('title') %>
</code></pre>
        <p>B.md</p>
        <pre><code class="language-javascript">---
title: Article B
date: 12-04-2014
---

# &lt;% get('title') %>
</code></pre>
        <p>C.md</p>
        <pre><code class="language-javascript">---
title: Article C
date: 22-02-2014
---

# &lt;% get('title') %>
</code></pre>
        <p>By using the <a href="/techy/docs/#using-yaml-front-matter">Yaml Front Matter</a> we are defining <code class="language-javascript">title</code> and <code class="language-javascript">date</code> properties for every page.</p>
        <p>If we go to the <code class="language-javascript">blog</code> directory and run <code class="language-javascript">techy --dest ./</code> command we will get three new files in the <code class="language-javascript">articles</code> directory - <code class="language-javascript">A.html</code>,
            <code
            class="language-javascript">B.html</code>and <code class="language-javascript">C.html</code>. So far so good. We have our pages generated and the users are able to see them. Now, we need to write our RSS. Let's create a new file in the <code class="language-javascript">blog</code> folder
                called <code class="language-javascript">feed.xml.source</code>. It will act as a template for the final file. Its extension is not <code class="language-javascript">.md</code> so Techy will not process it by default. We have to additionally
                point that out in the <code class="language-javascript">TechyFile.js</code> of the project:</p>
        <pre><code class="language-javascript">// blog/TechyFile.js

module.exports = function() {
    return {
        process: [
            'feed.xml.source'
        ]
    }
}
</code></pre>
        <p>Running <code class="language-javascript">techy --dest ./</code> command again brings <code class="language-javascript">feed.xml</code> file. The next step is to fetch all the pages in the blog and fill the xml with their titles and links. Here is
            how <code class="language-javascript">feed.xml.source</code> may look like:</p>
        <pre><code class="language-javascript">&lt;?xml version="1.0"?>
&lt;rss version="2.0">
  &lt;channel>
    &lt;title>Example Channel&lt;/title>
    &lt;link>http://example.com&lt;/link>
    &lt;description>My example channel&lt;/description>
    &lt;% rss() %>
  &lt;/channel>
&lt;/rss>
</code></pre>
        <p>The actual generation of the items is happening in a custom function <code class="language-javascript">rss</code>. Techy gives you ability to write such functions and put whatever you need there. All you have to do is to create a file with the
            function's name ending on <code class="language-javascript">techy.js</code> and the library will include it in the global scope. It's also nice that it is executed in the context of the current page so for example <code class="language-javascript">this.get</code> or
            <code
            class="language-javascript">this.set</code>are valid methods.</p>
        <pre><code class="language-javascript">// blog/rss.techy.js

module.exports = function() {
    var rss = '',
        pages = this.pages();

    var sortByDate = function(page1, page2) {
        var strToDate = function(str) {
            var tmp = str.split('-');
            return new Date(tmp[2], tmp[1], tmp[0]);
        }
        return strToDate(page1.get('date')) &lt; strToDate(page2.get('date'));
    }

    pages.sort(sortByDate);

    for(var i=0; i&lt;pages.length, page=pages[i]; i++) {
        rss += '\n&lt;item>';
        rss += '&lt;title>' + page.get('title') + '&lt;/title>';
        rss += '&lt;link>http://example.com/blog/' + page.get('paths').url + '&lt;/link>';
        rss += '&lt;/item>';
    }
    return rss;
}
</code></pre>
        <p>Notice that we are sorting the pages by the variable <code class="language-javascript">date</code> which is defined in the Markdown files.</p>
        <p>The final files tree looks like that:</p>
        <pre><code class="language-javascript">/blog
    /articles
        /A.html
        /A.md
        /B.html
        /B.md
        /C.html
        /C.md
    /public
    /themes
        // ... Techy's themes here
    /feed.xml
    /feed.xml.source
    /rss.techy.js
    /TechyFile.js
</code></pre>
        <p>The resulted <code class="language-javascript">feed.xml</code> contains all the three articles sorted by date:</p>
        <pre><code class="language-javascript">&lt;?xml version="1.0"?>
&lt;rss version="2.0">
  &lt;channel>
    &lt;title>Example Channel&lt;/title>
    &lt;link>http://example.com/&lt;/link>
    &lt;description>My example channel&lt;/description>
    &lt;item>&lt;title>Article B&lt;/title>&lt;link>http://example.com/blog/articles/B.html&lt;/link>&lt;/item>
    &lt;item>&lt;title>Article A&lt;/title>&lt;link>http://example.com/blog/articles/A.html&lt;/link>&lt;/item>
    &lt;item>&lt;title>Article C&lt;/title>&lt;link>http://example.com/blog/articles/C.html&lt;/link>&lt;/item>
  &lt;/channel>
&lt;/rss>
</code></pre>
        <p>The full code of the example could be found <a href="https://github.com/krasimir/techy/tree/gh-pages/examples/rss-generation/blog">here</a>.</p>
        <div class="social">
            <!-- Twitter --><a href="https://twitter.com/share" class="twitter-share-button" data-via="KrasimirTsonev" data-hashtags="Techy">Tweet</a>
            <script>
                ! function(d, s, id) {
                    var js, fjs = d.getElementsByTagName(s)[0],
                        p = /^http:/.test(d.location) ? 'http' : 'https';
                    if (!d.getElementById(id)) {
                        js = d.createElement(s);
                        js.id = id;
                        js.src = p + '://platform.twitter.com/widgets.js';
                        fjs.parentNode.insertBefore(js, fjs);
                    }
                }(document, 'script', 'twitter-wjs');
            </script>
            <!-- GitHub -->
            <iframe src="http://ghbtns.com/github-btn.html?user=krasimir&repo=techy&type=watch&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="100" height="20"></iframe>
        </div>
        <hr>
        <div class="grid">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'techy-nodejs';
                var disqus_identifier = "/techy/examples/rss-generation";
                var disqus_url = "http://krasimir.github.io/techy/examples/rss-generation";
                var disqus_title = "/techy/examples/rss-generation";
                (function() {
                    var dsq = document.createElement('script');
                    dsq.type = 'text/javascript';
                    dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
            </noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
        <p>
            <div class="grid footer-small">The page which you are looking right now is also generated with Techy.
                <br />If you are interested, checkout how the code looks like <a href="https://github.com/krasimir/techy/tree/gh-pages">here</a>.
                <br />
                <br />Made with <a href="http://gulpjs.com/">Gulp</a> and <a href="http://absurdjs.com">AbsurdJS</a>.</div>
            <script>
                (function(i, s, o, g, r, a, m) {
                    i['GoogleAnalyticsObject'] = r;
                    i[r] = i[r] || function() {
                        (i[r].q = i[r].q || []).push(arguments)
                    }, i[r].l = 1 * new Date();
                    a = s.createElement(o), m = s.getElementsByTagName(o)[0];
                    a.async = 1;
                    a.src = g;
                    m.parentNode.insertBefore(a, m)
                })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
                ga('create', 'UA-1621908-4', 'krasimir.github.io');
                ga('send', 'pageview');
            </script>
            <a href="https://github.com/krasimir/techy">
                <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67"
                alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png">
            </a>
        </p>
    </div>
    <script src="./../../public/prism/prism.js"></script>
    <script src="./../../public/absurd.organic.min.js"></script>
    <script src="./../../public/absurd.min.js"></script>
    <script src="./../../public/scripts.js"></script>
</body>

</html>